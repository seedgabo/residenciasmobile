{"version":3,"sources":["../../src/pages/workers/workers.module.ts","../../src/pages/workers/workers.ts"],"names":[],"mappings":"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","file":"5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { WorkersPage } from './workers';\nimport { PipesModule } from '../../pipes/pipes.module';\n@NgModule({\n  declarations: [WorkersPage],\n  imports: [\n    IonicPageModule.forChild(WorkersPage),\n    PipesModule\n  ],\n})\nexport class WorkersPageModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/workers/workers.module.ts","import { ToastController, ActionSheetController } from 'ionic-angular';\nimport { Api } from './../../providers/api';\nimport { Component } from '@angular/core';\nimport { NavController, NavParams } from 'ionic-angular';\n\nimport {IonicPage} from \"ionic-angular\";\n\n@IonicPage()\n@Component({\n  selector: 'page-workers',\n  templateUrl: 'workers.html',\n})\nexport class WorkersPage {\n  worker_image: any;\n  query = \"\"\n  workers = [];\n  constructor(public navCtrl: NavController, public navParams: NavParams, public api: Api, public toast: ToastController, public actionsheet: ActionSheetController) {\n    this.workers = this.api.residence.workers;\n  }\n  ionViewDidEnter() {\n    this.getData()\n  }\n\n  getData() {\n    this.api.get('workers?where[residence_id]=' + this.api.user.residence_id)\n      .then((data: any) => { this.api.workers = data; this.filter() })\n      .catch(console.error)\n  }\n\n  filter() {\n    if (this.query == \"\")\n      return this.workers = this.api.workers;\n    this.workers = this.api.workers.filter((worker) => {\n      if (worker.name.toLowerCase().indexOf(this.query.toLowerCase()) > -1)\n        return true;\n      return false;\n    });\n  }\n\n  addworker() {\n    this.navCtrl.push('WorkersEditorPage');\n  }\n\n  updateworker(worker) {\n    this.navCtrl.push('WorkersEditorPage', { worker: worker });\n  }\n\n  delete(worker) {\n    this.api.delete('workers/' + worker.id)\n      .then((data) => {\n        this.getData();\n      })\n      .catch((err) => {\n        console.error(err);\n      });\n  }\n\n\n  actions(worker) {\n    this.actionsheet.create({\n      title: this.api.trans('literals.actions') + \" | \" + worker.name,\n      buttons: [\n        {\n          text: this.api.trans('crud.edit'),\n          icon: 'create',\n          cssClass: 'icon-secondary',\n          handler: () => { this.updateworker(worker) }\n        },\n        {\n          text: this.api.trans('crud.edit') + \" \" + this.api.trans('literals.image'),\n          icon: 'camera',\n          cssClass: 'icon-purple',\n          handler: () => { this.askFile(worker) }\n        },\n        {\n          text: this.api.trans('crud.delete'),\n          icon: 'trash',\n          role: 'destructive',\n          cssClass: 'icon-danger',\n          handler: () => { this.delete(worker) }\n        }\n\n      ]\n    }).present();\n  }\n\n\n  askFile(worker) {\n    this.worker_image = worker;\n    var filer: any = document.querySelector(\"#input-file-worker\")\n    filer.click();\n  }\n\n  readFile(event) {\n    try {\n      var reader: any = new FileReader();\n      reader.readAsDataURL(event.target.files[0])\n      reader.onload = (result) => {\n        this.worker_image.image_url = result.target.result;\n        this.uploadImage(this.worker_image.id)\n      };\n    } catch (error) {\n      console.error(error)\n    }\n  }\n\n  uploadImage(id) {\n    return this.api.post('images/upload/worker/' + id, { image: this.worker_image.image_url })\n      .then((data: any) => {\n        console.log(data);\n        this.worker_image.image = data.image;\n        this.toast.create({\n          message: this.api.trans(\"literals.image\") + \" \" + this.api.trans(\"crud.updated\"),\n          duration: 1500,\n          showCloseButton: true,\n        }).present();\n      })\n      .catch(console.error)\n  }\n\n}\n\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/workers/workers.ts"],"sourceRoot":""}