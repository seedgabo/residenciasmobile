{"version":3,"sources":["../../src/pages/login/login.module.ts","../../src/pages/login/login.ts"],"names":[],"mappings":"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","file":"24.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { Login } from './login';\nimport { PipesModule } from '../../pipes/pipes.module';\n@NgModule({\n  declarations: [Login],\n  imports: [\n    IonicPageModule.forChild(Login),\n    PipesModule\n  ],\n})\nexport class LoginModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.module.ts","import { Component } from '@angular/core';\nimport { NavController, NavParams, AlertController, LoadingController, Events } from 'ionic-angular';\n\nimport { Api } from \"../../providers/api\";\nimport { Facebook } from '@ionic-native/facebook';\nimport { GooglePlus } from '@ionic-native/google-plus';\n\nimport {IonicPage} from \"ionic-angular\";\n\n@IonicPage()\n@Component({\n  selector: 'page-login',\n  templateUrl: 'login.html',\n})\nexport class Login {\n  forgot = false;\n  ready = false;\n  servers = {};\n  code = \"\";\n  constructor(public facebook: Facebook, public google: GooglePlus, public navCtrl: NavController, public navParams: NavParams, public api: Api, public alertCtrl: AlertController, public loadingCtrl: LoadingController, public events: Events) {\n  }\n\n  ionViewDidLoad() {\n    this.getServers();\n  }\n\n  verifyCode() {\n    if (this.servers[this.code] !== undefined) {\n      var server = this.servers[this.code]\n      this.api.url = server.url;\n      this.api.storage.set('url', server.url);\n    }\n  }\n  goBack() {\n    this.api.url = null;\n    this.api.storage.remove('url');\n  }\n\n  login() {\n    let loading = this.loadingCtrl.create({\n      content: `\n      <div>\n        <img class=\"loading-img\" src=\"${this.api.url + \"img/logo.png\"}\" alt=\"\">\n        <h3>Cargando ...</h3>\n      </div>`,\n      spinner: 'hide',\n    });\n\n    loading.present();\n    this.api.doLogin()\n      .then((data: any) => {\n        this.api.user = data.user;\n        this.api.storage.set('user', data.user).then(() => {\n          loading.dismiss();\n          this.goTo()\n          console.log(data);\n        });\n      })\n\n      .catch((err) => {\n        console.error(err);\n        let alert = this.alertCtrl.create({\n          title: \"Error\",\n          subTitle: 'Usuario y Contraseña Invalidos',\n          buttons: ['OK']\n        });\n        loading.dismiss();\n        alert.present();\n\n      });\n  }\n\n  loginWithFacebook() {\n    let loading = this.loadingCtrl.create({\n      content: `\n      <div>\n        <img class=\"loading-img\" src=\"${this.api.url + \"img/logo-completo.png\"}\" alt=\"\">\n        <h3>Cargando ...</h3>\n      </div>`,\n      spinner: 'hide',\n    });\n    loading.present();\n    this.facebook.login(['public_profile', 'email'])\n      .then((data) => {\n        console.log(data);\n        this.facebook.api(`${data.authResponse.userID}/?fields=id,email,name,picture,first_name,last_name,gender`, ['public_profile', 'email']).then((data) => {\n          console.log(data);\n          this.api.loginOAuth(data).then((data) => {\n            console.log(data);\n            this.api.saveData(data);\n            this.goTo();\n            loading.dismiss();\n          }).catch((err) => {\n            console.error(err);\n            loading.dismiss();\n            this.alertCtrl.create({\n              message: JSON.stringify(err),\n              title: \"Error\",\n            }).present();\n\n          });\n        }).catch((err) => {\n          console.error(err);\n          loading.dismiss();\n          this.alertCtrl.create({\n            message: err,\n            title: \"Error\",\n          }).present();\n\n        })\n      }).catch((err) => {\n        console.error(err);\n        loading.dismiss();\n        this.alertCtrl.create({\n          message: err,\n          title: \"Error\",\n        }).present();\n\n      });\n  }\n\n  loginWithGoogle() {\n    let loading = this.loadingCtrl.create({\n      content: `\n      <div>\n        <img class=\"loading-img\" src=\"${this.api.url + \"img/logo-completo.png\"}\" alt=\"\">\n        <h3>Cargando ...</h3>\n      </div>`,\n      spinner: 'hide',\n    });\n    loading.present();\n    this.google.login({})\n      .then((data) => {\n        console.log(data);\n        loading.dismiss();\n      })\n      .catch((err) => {\n        console.error(err);\n        loading.dismiss();\n        this.alertCtrl.create({\n          message: err,\n          title: \"Error\",\n        }).present();\n      });\n  }\n\n  recover(email) {\n    this.api.post('forgot-password', { email: email })\n      .then(() => {\n        let alert = this.alertCtrl.create({\n          title: \"Listo!\",\n          subTitle: 'Le hemos enviado un correo de recuperación',\n          buttons: ['OK']\n        });\n        alert.present();\n      })\n      .catch(() => {\n        let alert = this.alertCtrl.create({\n          title: \"Error\",\n          subTitle: 'No hemos podido validar el usuario asegurese de escribirlo correctamente',\n          buttons: ['OK']\n        });\n        alert.present();\n      });\n  }\n\n  getServers() {\n    this.api.http.get('http://residenciasonline.com/residencias/public/servers.json')\n      .map(res => res.json())\n      .subscribe(data => {\n        this.servers = data\n        this.ready = true\n        console.log(this.servers);\n      }, (err) => { console.error(err) });\n  }\n  goTo() {\n    this.events.publish('login', {});\n    this.navCtrl.setRoot('HomePage');\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.ts"],"sourceRoot":""}