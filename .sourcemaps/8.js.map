{"version":3,"sources":["../../src/pages/visitors/visitors.module.ts","../../src/pages/visitors/visitors.ts"],"names":[],"mappings":"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","file":"8.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { VisitorsPage } from './visitors';\nimport { PipesModule } from '../../pipes/pipes.module';\n\n@NgModule({\n  declarations: [VisitorsPage],\n  imports: [\n    IonicPageModule.forChild(VisitorsPage),\n    PipesModule\n  ],\n})\nexport class VisitorsPageModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/visitors/visitors.module.ts","import { Component } from '@angular/core';\nimport { NavController, NavParams, ModalController, ActionSheetController, ToastController, IonicPage } from 'ionic-angular';\nimport { Api } from \"../../providers/api\";\n\n\n@IonicPage()\n@Component({\n  selector: 'page-visitors',\n  templateUrl: 'visitors.html',\n})\nexport class VisitorsPage {\n  visitor_image: any;\n  query = \"\";\n  visitors = [];\n  selecteds = [];\n  constructor(public navCtrl: NavController, public navParams: NavParams, public api: Api, public modal: ModalController, public actionsheet: ActionSheetController, public toast: ToastController) {\n  }\n\n  ionViewDidLoad() {\n    this.visitors = this.api.visitors;\n  }\n\n  ionViewDidEnter() {\n    this.selecteds = [];\n    this.visitors.forEach((v) => {\n      v.selected = false;\n    })\n  }\n\n  addVisitor() {\n    this.modal.create('NewVisitorPage', {}, { showBackdrop: true, enableBackdropDismiss: true }).present();\n  }\n\n  updateVisitor(visitor) {\n    this.modal.create('NewVisitorPage', { visitor: visitor }, { showBackdrop: true, enableBackdropDismiss: true }).present();\n  }\n\n  filter() {\n    if (this.query == \"\")\n      return this.visitors = this.api.visitors;\n    this.visitors = this.api.visitors.filter((visitor) => {\n      if (visitor.name.toLowerCase().indexOf(this.query.toLowerCase()) > -1 || visitor.document.toLowerCase().indexOf(this.query.toLowerCase()) > -1)\n        return true;\n      return false;\n    });\n  }\n\n  toggleSelect(visitor) {\n    if (visitor.selected) {\n      visitor.selected = false\n      this.selecteds.splice(this.selecteds.indexOf(visitor), 1);\n    } else {\n      visitor.selected = true\n      this.selecteds.push(visitor);\n    }\n  }\n\n  addVisit(visitor) {\n    var modal = this.modal.create('CreateVisitPage', { visitor: visitor }, { showBackdrop: true, enableBackdropDismiss: true })\n    modal.present();\n    modal.onDidDismiss(() => {\n      this.ionViewDidEnter();\n    })\n\n  }\n\n  delete(visitor) {\n    this.api.delete('visitors/' + visitor.id).catch((err) => {\n      console.error(err);\n    });\n  }\n\n  actions(visitor) {\n    this.actionsheet.create({\n      title: this.api.trans('literals.actions') + \" | \" + visitor.name,\n      buttons: [\n        {\n          text: this.api.trans('__.Seleccionar para visita multiple'),\n          icon: 'checkmark-circle',\n          cssClass: 'icon-favorite',\n          handler: () => { this.toggleSelect(visitor) }\n        },\n        {\n          text: this.api.trans('literals.generate') + \" \" + this.api.trans('literals.visit'),\n          icon: 'person-add',\n          cssClass: 'icon-primary',\n          handler: () => { this.addVisit(visitor) }\n        },\n        {\n          text: this.api.trans('crud.edit'),\n          icon: 'create',\n          cssClass: 'icon-secondary',\n          handler: () => { this.updateVisitor(visitor) }\n        },\n        {\n          text: this.api.trans('crud.edit') + \" \" + this.api.trans('literals.image'),\n          icon: 'camera',\n          cssClass: 'icon-purple',\n          handler: () => { this.askFile(visitor) }\n        },\n        {\n          text: this.api.trans('crud.delete'),\n          icon: 'trash',\n          role: 'destructive',\n          cssClass: 'icon-danger',\n          handler: () => { this.delete(visitor) }\n        }\n\n      ]\n    }).present();\n  }\n\n  askFile(visitor) {\n    this.visitor_image = visitor;\n    var filer: any = document.querySelector(\"#input-file\")\n    filer.click();\n  }\n\n  readFile(event) {\n    try {\n      var reader: any = new FileReader();\n      reader.readAsDataURL(event.target.files[0])\n      reader.onload = (result) => {\n        this.visitor_image.image_url = result.target.result;\n        this.uploadImage(this.visitor_image.id)\n      };\n    } catch (error) {\n      console.error(error)\n    }\n  }\n\n  uploadImage(id) {\n    return this.api.post('images/upload/visitor/' + id, { image: this.visitor_image.image_url })\n      .then((data: any) => {\n        console.log(data);\n        this.visitor_image.image = data.image;\n        this.toast.create({\n          message: this.api.trans(\"literals.image\") + \" \" + this.api.trans(\"crud.updated\"),\n          duration: 1500,\n          showCloseButton: true,\n        }).present();\n      })\n      .catch(console.error)\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/visitors/visitors.ts"],"sourceRoot":""}